function getColor(e){return e>35e3?"#b10026":e>3e4?"#e31a1c":e>25e3?"#fc4e2a":e>2e4?"#fd8d3c":e>15e3?"#feb24c":e>1e4?"#fed976":e>5e3?"#ffeda0":"#ffffcc"}function getColorPink(e){return e>21e3?"#99000d":e>18e3?"#cb181d":e>15e3?"#ef3b2c":e>12e3?"#fb6a4a":e>9e3?"#fc9272":e>6e3?"#fcbba1":e>3e3?"#fee0d2":"#fff5f0"}function getColorBlue(e){return e>21e3?"#084594":e>18e3?"#2171b5":e>15e3?"#4292c6":e>12e3?"#6baed6":e>9e3?"#9ecae1":e>6e3?"#c6dbef":e>3e3?"#deebf7":"#f7fbff"}function style(e){return globalStyle.fillColor=getColor(e.properties.pdt_2016),globalStyle}function highlightFeature(e){var t=e.target;t.setStyle({weight:5,color:"#666",dashArray:"3",fillOpacity:.9}),L.Browser.ie||L.Browser.opera||t.bringToFront()}function resetHighlight(e){var t=e.target;t.setStyle({weight:1,opacity:1,color:"white",dashArray:"3",fillOpacity:.9})}function openModal(e){var t=e.target.feature.properties.url;$.getJSON("src/json/data-agregasi.json",function(e){for(var a=e.length,o=0;a>o;o++)e[o].url==t&&(dataStatistik(e[o]),$("#namaKecamatan").text("Demografi Kependudukan & Pendidikan di Kecamatan "+e[o].kecamatan),$("#luasWilayah").text(e[o].luas_wilayah),$("#kawasan").text(e[o].kawasan),$("#populasi").text(accounting.formatNumber(e[o].pop_2016,0,".")),$("#jumlahKelurahan").text(e[o].jumlah_kelurahan),$("#jumlahSD").text(accounting.formatNumber(e[o].jml_sd,0,".")),$("#jumlahSMP").text(accounting.formatNumber(e[o].jml_smp,0,".")),$("#jumlahSMA").text(accounting.formatNumber(e[o].jml_sma,0,".")),$("#jumlahSMK").text(accounting.formatNumber(e[o].jml_smk,0,".")),$("#jumlahKeaksaraan").text(accounting.formatNumber(e[o].jml_keaksaraan,0,".")),$("#usiaSD").text(accounting.formatNumber(e[o].umur_7_12,0,".")),$("#usiaSMP").text(accounting.formatNumber(e[o].umur_13_15,0,".")),$("#usiaSMA").text(accounting.formatNumber(e[o].umur_16_18,0,".")),$("#jumlahPtkSD").text(accounting.formatNumber(e[o].jml_ptk_sd,0,".")),$("#jumlahPtkSMP").text(accounting.formatNumber(e[o].jml_ptk_smp,0,".")),$("#jumlahPtkSMA").text(accounting.formatNumber(e[o].jml_ptk_sma,0,".")),$("#jumlahPtkSMK").text(accounting.formatNumber(e[o].jml_ptk_smk,0,".")),$("#jumlahPtkKeaksaraan").text(accounting.formatNumber(e[o].jml_ptk_keaksaraan,0,".")),$("#jumlahPdSD").text(accounting.formatNumber(e[o].jml_pd_sd,0,".")),$("#jumlahPdSMP").text(accounting.formatNumber(e[o].jml_pd_smp,0,".")),$("#jumlahPdSMA").text(accounting.formatNumber(e[o].jml_pd_sma,0,".")),$("#jumlahPdSMK").text(accounting.formatNumber(e[o].jml_pd_smk,0,".")),$("#jumlahPdKeaksaraan").text(accounting.formatNumber(e[o].jml_pd_keaksaraan,0,".")))}),$("#statsModal").modal("show"),e.target.getBounds()}function dataStatistik(e){var t=Highcharts.chart("statistik",{chart:{type:"line",style:{fontFamily:"PT Sans"}},title:{text:"Statistik Kependudukan di Kecamatan "+e.kecamatan+" Tahun 2008 - 2016"},subtitle:{text:"Sumber: Portal Data Bandung"},plotOptions:{line:{dataLabels:{enabled:!0},enableMouseTracking:!1}},xAxis:{categories:["2008","2009","2010","2011","2012","2013","2014","2015","2016"],title:{text:"Tahun"}},yAxis:{min:0,title:{text:"Jumlah Penduduk"}},series:[{name:"Jumlah Populasi",data:[e.pop_2008,e.pop_2009,e.pop_2010,e.pop_2011,e.pop_2012,e.pop_2013,e.pop_2014,e.pop_2015,e.pop_2016]},{name:"Jumlah Kepadatan Penduduk (km2)",data:[e.pdt_2008,e.pdt_2009,e.pdt_2010,e.pdt_2011,e.pdt_2012,e.pdt_2013,e.pdt_2014,e.pdt_2015,e.pdt_2016]},{name:"Jumlah Populasi Pria",data:[e.pop_pria_2008,e.pop_pria_2009,e.pop_pria_2010,e.pop_pria_2011,e.pop_pria_2012,e.pop_pria_2013,e.pop_pria_2014,e.pop_pria_2015,e.pop_pria_2016],visible:!1},{name:"Jumlah Kepadatan Penduduk Pria (km2)",data:[e.pdt_pria_2008,e.pdt_pria_2009,e.pdt_pria_2010,e.pdt_pria_2011,e.pdt_pria_2012,e.pdt_pria_2013,e.pdt_pria_2014,e.pdt_pria_2015,e.pdt_pria_2016],visible:!1},{name:"Jumlah Populasi Wanita",data:[e.pop_wanita_2008,e.pop_wanita_2009,e.pop_wanita_2010,e.pop_wanita_2011,e.pop_wanita_2012,e.pop_wanita_2013,e.pop_wanita_2014,e.pop_wanita_2015,e.pop_wanita_2016],visible:!1},{name:"Jumlah Kepadatan Penduduk Wanita (km2)",data:[e.pdt_wanita_2009,e.pdt_wanita_2009,e.pdt_wanita_2010,e.pdt_wanita_2011,e.pdt_wanita_2012,e.pdt_wanita_2013,e.pdt_wanita_2014,e.pdt_wanita_2015,e.pdt_wanita_2016],visible:!1}]});return t}function onEachFeature(e,t){t.on({mouseover:highlightFeature,mouseout:resetHighlight,click:openModal}),t.bindLabel("Kecamatan "+t.feature.properties.kecamatan,{permanent:!0})}L.mapbox.accessToken="pk.eyJ1IjoidHJ5ZmF0dXIiLCJhIjoiY2lxdDJ5d3R1MDAydmZybmh3a3VtcmFvMiJ9.lL9RoXOtTscOHiSvOCrL-Q";var map=L.mapbox.map("map").setView([-6.90962,107.634553],13),info=L.control(),datasource=L.control(),legend=L.control({position:"bottomright"}),geojson,globalStyle={weight:1,opacity:1,color:"white",dashArray:"3",fillOpacity:.9},kategori=[{text:"Kepadatan Penduduk",value:"density"},{text:"Kepadatan Penduduk Pria",value:"densityMale"},{text:"Kepadatan Penduduk Wanita",value:"densityFemale"}],tahun=[{text:"2016",value:"2016"},{text:"2015",value:"2015"},{text:"2014",value:"2014"},{text:"2013",value:"2013"},{text:"2012",value:"2012"},{text:"2011",value:"2011"},{text:"2010",value:"2010"},{text:"2009",value:"2009"},{text:"2008",value:"2008"}];L.tileLayer("https://api.mapbox.com/styles/v1/mapbox/streets-v10/tiles/256/{z}/{x}/{y}?access_token="+L.mapbox.accessToken).addTo(map),info.onAdd=function(e){return this._div=L.DomUtil.create("div","info"),this._div.innerHTML="<h4><b>Demografi Kependudukan dan Pendidikan Kota Bandung</b></h4>",this._div},info.update=function(e){this._div.innerHTML="<h4><b>Peta Tematik Kepadatan Kota Bandung</b></h4>"+(e?"<b>Kecamatan: "+e.kecamatan+"</b>":"Pilih Kecamatan")},info.addTo(map),datasource.onAdd=function(e){return this._div=L.DomUtil.create("div","info"),this._div.innerHTML='<b>Kategori: </b><select id="kategori"></select> <b>Tahun: </b><select id="tahun"></select>',this._div},datasource.addTo(map);var grades={general:[0,5e3,1e4,15e3,2e4,25e3,3e4,35e3],gender:[0,3e3,6e3,9e3,12e3,15e3,18e3,21e3]};legend.onAdd=function(e){var t=L.DomUtil.create("div","info legend");return $("#kategori").change(function(){if("densityMale"==this.value)for(var e=0;e<grades.gender.length;e++)t.innerHTML+='<i style="background:'+getColorBlue(grades.gender[e]+1)+'"></i> '+grades.gender[e]+(grades.gender[e+1]?"&ndash;"+grades.gender[e+1]+"<br>":"+");else if("densityFemale"==this.value)for(var e=0;e<grades.gender.length;e++)t.innerHTML+='<i style="background:'+getColorPink(grades.gender[e]+1)+'"></i> '+grades.gender[e]+(grades.gender[e+1]?"&ndash;"+grades.gender[e+1]+"<br>":"+");else for(var e=0;e<grades.general.length;e++)t.innerHTML+='<i style="background:'+getColor(grades.general[e]+1)+'"></i> '+grades.general[e]+(grades.general[e+1]?"&ndash;"+grades.general[e+1]+"<br>":"+")}),t},geojson=L.geoJson(baseMap,{style:style,onEachFeature:onEachFeature}),geojson.addTo(map),$("#kategori").append('<option value="">-- Pilih Kategori --</option>'),$.each(kategori,function(e){$("#kategori").append('<option value="'+kategori[e].value+'">'+kategori[e].text+"</option>")});var dataKategori;$("#tahun").append('<option value="">-- Pilih Kategori --</option>'),$("#kategori").change(function(){dataKategori=this.value,$("#tahun").empty(),$("#tahun").append('<option value="">-- Pilih Tahun --</option>'),$.each(tahun,function(e){$("#tahun").append('<option value="'+tahun[e].value+'">'+tahun[e].text+"</option>")})}),$("#tahun").change(function(){switch(this.value){case"2016":"densityMale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorBlue(e.properties.pdt_pria_2016)}}):"densityFemale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorPink(e.properties.pdt_wanita_2016)}}):geojson.setStyle(function(e){return{fillColor:getColor(e.properties.pdt_2016)}});break;case"2015":"densityMale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorBlue(e.properties.pdt_pria_2015)}}):"densityFemale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorPink(e.properties.pdt_wanita_2015)}}):geojson.setStyle(function(e){return{fillColor:getColor(e.properties.pdt_2015)}});break;case"2014":"densityMale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorBlue(e.properties.pdt_pria_2014)}}):"densityFemale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorPink(e.properties.pdt_wanita_2014)}}):geojson.setStyle(function(e){return{fillColor:getColor(e.properties.pdt_2014)}});break;case"2013":"densityMale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorBlue(e.properties.pdt_pria_2013)}}):"densityFemale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorPink(e.properties.pdt_wanita_2013)}}):geojson.setStyle(function(e){return{fillColor:getColor(e.properties.pdt_2013)}});break;case"2012":"densityMale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorBlue(e.properties.pdt_pria_2012)}}):"densityFemale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorPink(e.properties.pdt_wanita_2012)}}):geojson.setStyle(function(e){return{fillColor:getColor(e.properties.pdt_2012)}});break;case"2011":"densityMale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorBlue(e.properties.pdt_pria_2011)}}):"densityFemale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorPink(e.properties.pdt_wanita_2011)}}):geojson.setStyle(function(e){return{fillColor:getColor(e.properties.pdt_2011)}});break;case"2010":"densityMale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorBlue(e.properties.pdt_pria_2010)}}):"densityFemale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorPink(e.properties.pdt_wanita_2010)}}):geojson.setStyle(function(e){return{fillColor:getColor(e.properties.pdt_2010)}});break;case"2009":"densityMale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorBlue(e.properties.pdt_pria_2009)}}):"densityFemale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorPink(e.properties.pdt_wanita_2009)}}):geojson.setStyle(function(e){return{fillColor:getColor(e.properties.pdt_2009)}});break;case"2008":"densityMale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorBlue(e.properties.pdt_pria_2008)}}):"densityFemale"==dataKategori?geojson.setStyle(function(e){return{fillColor:getColorPink(e.properties.pdt_wanita_2008)}}):geojson.setStyle(function(e){return{fillColor:getColor(e.properties.pdt_2008)}})}}),map.attributionControl.addAttribution('Data Kependudukan &copy; <a href="http://disdukcapil.bandung.go.id/">Dinas Kependudukan dan Pencatatan Sipil</a>'),map.attributionControl.addAttribution('<a href="http://portal.bandung.go.id/" target="_blank">Tim Open Data Kota Bandung</a> &copy 2016.');