function getColor(a){return a>35e3?"#b10026":a>3e4?"#e31a1c":a>25e3?"#fc4e2a":a>2e4?"#fd8d3c":a>15e3?"#feb24c":a>1e4?"#fed976":a>5e3?"#ffeda0":"#ffffcc"}function getColorPink(a){return a>21e3?"#99000d":a>18e3?"#cb181d":a>15e3?"#ef3b2c":a>12e3?"#fb6a4a":a>9e3?"#fc9272":a>6e3?"#fcbba1":a>3e3?"#fee0d2":"#fff5f0"}function getColorBlue(a){return a>21e3?"#084594":a>18e3?"#2171b5":a>15e3?"#4292c6":a>12e3?"#6baed6":a>9e3?"#9ecae1":a>6e3?"#c6dbef":a>3e3?"#deebf7":"#f7fbff"}function style(a){return globalStyle.fillColor=getColor(a.properties._kepadatan._2015),globalStyle}function highlightFeature(a){var b=a.target;b.setStyle({weight:5,color:"#666",dashArray:"3",fillOpacity:.9}),L.Browser.ie||L.Browser.opera||b.bringToFront(),info.update(b.feature.properties)}function resetHighlight(a){var b=a.target;b.setStyle({weight:1,opacity:1,color:"white",dashArray:"3",fillOpacity:.9}),info.update()}function openModal(a){var b=a.target.feature.properties._url;$.getJSON("src/json/data.json",function(a){for(var c=a.length,d="",e=0;e<c;e++)if(a[e].url==b){dataStatistik(a[e]),$("#luasWilayah").text(": "+a[e].luas_wilayah+" Km2"),$("#kawasan").text(": "+a[e].kawasan);for(var f=a[e].kelurahan.length,g=0;g<f;g++)d+=a[e].kelurahan[g]+", ";$("#kelurahan").text(": "+d)}}),$("#statsModal").modal("show"),a.target.getBounds()}function dataStatistik(a){$(function(){$("#statistik").highcharts({chart:{type:"line",width:890,style:{fontFamily:"PT Sans"}},title:{text:"Data Kependudukan di Kecamatan "+a.kecamatan+" Tahun 2009 - 2015"},subtitle:{text:"Sumber: Portal Data Bandung"},plotOptions:{line:{dataLabels:{enabled:!0},enableMouseTracking:!1}},xAxis:{categories:["2009","2010","2011","2012","2013","2014","2015"],title:{text:"Tahun"}},yAxis:{min:0,title:{text:"Jumlah Penduduk"}},series:[{name:"Jumlah Populasi",data:[a.populasi.p_2009,a.populasi.p_2010,a.populasi.p_2011,a.populasi.p_2012,a.populasi.p_2013,a.populasi.p_2014,a.populasi.p_2015]},{name:"Jumlah Kepadatan Penduduk (km2)",data:[a.kepadatan.k_2009,a.kepadatan.k_2010,a.kepadatan.k_2011,a.kepadatan.k_2012,a.kepadatan.k_2013,a.kepadatan.k_2014,a.kepadatan.k_2015]},{name:"Jumlah Populasi Pria",data:[a.populasi_pria.pp_2009,a.populasi_pria.pp_2010,a.populasi_pria.pp_2011,a.populasi_pria.pp_2012,a.populasi_pria.pp_2013,a.populasi_pria.pp_2014,a.populasi_pria.pp_2015],visible:!1},{name:"Jumlah Kepadatan Penduduk Pria (km2)",data:[a.kepadatan_pria.kp_2009,a.kepadatan_pria.kp_2010,a.kepadatan_pria.kp_2011,a.kepadatan_pria.kp_2012,a.kepadatan_pria.kp_2013,a.kepadatan_pria.kp_2014,a.kepadatan_pria.kp_2015],visible:!1},{name:"Jumlah Populasi Wanita",data:[a.populasi_wanita.pw_2009,a.populasi_wanita.pw_2010,a.populasi_wanita.pw_2011,a.populasi_wanita.pw_2012,a.populasi_wanita.pw_2013,a.populasi_wanita.pw_2014,a.populasi_wanita.pw_2015],visible:!1},{name:"Jumlah Kepadatan Penduduk Wanita (km2)",data:[a.kepadatan_wanita.kw_2009,a.kepadatan_wanita.kw_2010,a.kepadatan_wanita.kw_2011,a.kepadatan_wanita.kw_2012,a.kepadatan_wanita.kw_2013,a.kepadatan_wanita.kw_2014,a.kepadatan_wanita.kw_2015],visible:!1}]})})}function onEachFeature(a,b){b.on({mouseover:highlightFeature,mouseout:resetHighlight,click:openModal})}L.mapbox.accessToken="pk.eyJ1IjoidHJ5ZmF0dXIiLCJhIjoiY2lxdDJ5d3R1MDAydmZybmh3a3VtcmFvMiJ9.lL9RoXOtTscOHiSvOCrL-Q";var map=L.mapbox.map("map").setView([-6.90962,107.634553],13),info=L.control(),datasource=L.control(),legend=L.control({position:"bottomright"}),geojson,globalStyle={weight:1,opacity:1,color:"white",dashArray:"3",fillOpacity:.9},kategori=[{text:"Kepadatan Penduduk",value:"density"},{text:"Kepadatan Penduduk Pria",value:"densityMale"},{text:"Kepadatan Penduduk Wanita",value:"densityFemale"}],tahun=[{text:"2015",value:"2015"},{text:"2014",value:"2014"},{text:"2013",value:"2013"},{text:"2012",value:"2012"},{text:"2010",value:"2010"},{text:"2009",value:"2009"}];L.tileLayer("https://api.mapbox.com/styles/v1/mapbox/dark-v9/tiles/256/{z}/{x}/{y}?access_token="+L.mapbox.accessToken).addTo(map),info.onAdd=function(a){return this._div=L.DomUtil.create("div","info"),this.update(),this._div},info.update=function(a){this._div.innerHTML="<h4><b>Peta Tematik Kepadatan Kota Bandung</b></h4>"+(a?"<b>Kecamatan: "+a._kecamatan+"</b>":"Pilih Kecamatan")},info.addTo(map),datasource.onAdd=function(a){return this._div=L.DomUtil.create("div","info"),this._div.innerHTML='<b>Kategori: </b><select id="kategori"></select> <b>Tahun: </b><select id="tahun"></select>',this._div},datasource.addTo(map);var grades={general:[0,5e3,1e4,15e3,2e4,25e3,3e4,35e3],gender:[0,3e3,6e3,9e3,12e3,15e3,18e3,21e3]};legend.onAdd=function(a){var b=L.DomUtil.create("div","info legend");return $("#kategori").change(function(){if("densityMale"==this.value)for(var a=0;a<grades.gender.length;a++)b.innerHTML+='<i style="background:'+getColorBlue(grades.gender[a]+1)+'"></i> '+grades.gender[a]+(grades.gender[a+1]?"&ndash;"+grades.gender[a+1]+"<br>":"+");else if("densityFemale"==this.value)for(var a=0;a<grades.gender.length;a++)b.innerHTML+='<i style="background:'+getColorPink(grades.gender[a]+1)+'"></i> '+grades.gender[a]+(grades.gender[a+1]?"&ndash;"+grades.gender[a+1]+"<br>":"+");else for(var a=0;a<grades.general.length;a++)b.innerHTML+='<i style="background:'+getColor(grades.general[a]+1)+'"></i> '+grades.general[a]+(grades.general[a+1]?"&ndash;"+grades.general[a+1]+"<br>":"+")}),b},geojson=L.geoJson(baseMap,{style:style,onEachFeature:onEachFeature}),geojson.addTo(map),$("#kategori").append('<option value="">-- Pilih Kategori --</option>'),$.each(kategori,function(a){$("#kategori").append('<option value="'+kategori[a].value+'">'+kategori[a].text+"</option>")});var dataKategori;$("#tahun").append('<option value="">-- Pilih Kategori --</option>'),$("#kategori").change(function(){dataKategori=this.value,$("#tahun").empty(),$("#tahun").append('<option value="">-- Pilih Tahun --</option>'),$.each(tahun,function(a){$("#tahun").append('<option value="'+tahun[a].value+'">'+tahun[a].text+"</option>")})}),$("#tahun").change(function(){switch(this.value){case"2015":"densityMale"==dataKategori?geojson.setStyle(function(b){return{fillColor:getColorBlue(b.properties._kepadatan_pria.kp_2015)}}):"densityFemale"==dataKategori?geojson.setStyle(function(b){return{fillColor:getColorPink(b.properties._kepadatan_wanita.kw_2015)}}):geojson.setStyle(function(b){return{fillColor:getColor(b.properties._kepadatan._2015)}});break;case"2014":"densityMale"==dataKategori?geojson.setStyle(function(b){return{fillColor:getColorBlue(b.properties._kepadatan_pria.kp_2014)}}):"densityFemale"==dataKategori?geojson.setStyle(function(b){return{fillColor:getColorPink(b.properties._kepadatan_wanita.kw_2014)}}):geojson.setStyle(function(b){return{fillColor:getColor(b.properties._kepadatan._2014)}});break;case"2013":"densityMale"==dataKategori?geojson.setStyle(function(b){return{fillColor:getColorBlue(b.properties._kepadatan_pria.kp_2013)}}):"densityFemale"==dataKategori?geojson.setStyle(function(b){return{fillColor:getColorPink(b.properties._kepadatan_wanita.kw_2013)}}):geojson.setStyle(function(b){return{fillColor:getColor(b.properties._kepadatan._2013)}});break;case"2012":"densityMale"==dataKategori?geojson.setStyle(function(b){return{fillColor:getColorBlue(b.properties._kepadatan_pria.kp_2012)}}):"densityFemale"==dataKategori?geojson.setStyle(function(b){return{fillColor:getColorPink(b.properties._kepadatan_wanita.kw_2012)}}):geojson.setStyle(function(b){return{fillColor:getColor(b.properties._kepadatan._2012)}});break;case"2010":"densityMale"==dataKategori?geojson.setStyle(function(b){return{fillColor:getColorBlue(b.properties._kepadatan_pria.kp_2010)}}):"densityFemale"==dataKategori?geojson.setStyle(function(b){return{fillColor:getColorPink(b.properties._kepadatan_wanita.kw_2010)}}):geojson.setStyle(function(b){return{fillColor:getColor(b.properties._kepadatan._2010)}});break;case"2009":"densityMale"==dataKategori?geojson.setStyle(function(b){return{fillColor:getColorBlue(b.properties._kepadatan_pria.kp_2009)}}):"densityFemale"==dataKategori?geojson.setStyle(function(b){return{fillColor:getColorPink(b.properties._kepadatan_wanita.kw_2009)}}):geojson.setStyle(function(b){return{fillColor:getColor(b.properties._kepadatan._2009)}})}}),map.attributionControl.addAttribution('Data Kependudukan &copy; <a href="http://data.bandung.go.id/">Portal Data Bandung</a>'),map.attributionControl.addAttribution('<a href="https://github.com/tryfatur" target="_blank">Try Fathur Rachman</a> &copy 2016.');